# Поиск изображений по текстовому описанию

## Описание исследования

В рамках проекта была разработана демонстрационная версия системы поиска изображений по текстовому запросу. Пользователь вводит описание сцены, а система возвращает несколько изображений, наиболее соответствующих заданному описанию.

Целью работы являлась реализация Proof of Concept (PoC), демонстрирующего практическую реализуемость мультимодального поиска — сопоставления текстового описания и изображения с последующей оценкой степени их соответствия.

В отличие от бинарной классификации, задача формализована как регрессия: модель должна выдавать число в диапазоне от 0 до 1, отражающее уровень семантической согласованности текста и изображения.

---

## Исходные данные

В распоряжении находились:

- обучающая выборка изображений с текстовыми описаниями;
- экспертные оценки степени соответствия текста и изображения;
- пользовательские оценки;
- отдельный тестовый набор изображений для проверки качества поиска.

Целевая переменная формировалась на основе агрегированных экспертных оценок и нормировалась в диапазон [0, 1].

---

## Методология решения

### Векторизация данных

Для получения признакового пространства использовались:

- **ResNet50** — для извлечения визуальных эмбеддингов изображений;
- **BERT base (English)** — для получения текстовых эмбеддингов.

Текстовые и визуальные представления объединялись в единый вектор путём конкатенации. Таким образом формировалось мультимодальное признаковое пространство фиксированной размерности.

### Обучение моделей

Для оценки соответствия были протестированы три регрессионные модели различной сложности:

- **LinearRegression** — линейный baseline;
- **CatBoostRegressor** — градиентный бустинг для моделирования нелинейных зависимостей;
- **Многослойная нейронная сеть (MLP)** — архитектура с Batch Normalization, Dropout и L2-регуляризацией.

Оценка качества выполнялась с использованием групповой кросс-валидации по идентификатору изображения, что позволило избежать утечки информации между фолдами.

Основные метрики:
- RMSE — чувствительная к крупным ошибкам;
- MAE — устойчивая средняя абсолютная ошибка;
- корреляции Пирсона и Спирмена — для анализа качества ранжирования.

---

## Результаты

Линейная регрессия продемонстрировала умеренное качество, подтвердив наличие линейной зависимости между объединёнными эмбеддингами и экспертной оценкой, однако её выразительности оказалось недостаточно.

CatBoost показал улучшение за счёт учёта нелинейных взаимодействий признаков и продемонстрировал более устойчивое поведение.

Наилучшие результаты среди протестированных моделей продемонстрировала многослойная нейронная сеть. Она позволила эффективнее моделировать сложные зависимости между текстовыми и визуальными представлениями и сформировать более адекватное ранжирование изображений.

Была реализована функция, принимающая текстовый запрос и возвращающая топ-5 наиболее релевантных изображений с указанием предсказанного скора соответствия.

Тем не менее, качество поиска остаётся ограниченным: корректное изображение не всегда попадает в топ-5, хотя тематически близкие изображения часто оказываются среди лидеров. Это указывает на ограничения выбранной схемы объединения эмбеддингов.

---

## Ограничения текущего подхода

Основное ограничение заключается в том, что текстовые и визуальные эмбеддинги формировались независимыми моделями, а их согласование происходило постфактум через регрессионный алгоритм. Такая архитектура не обучается непосредственно на задаче сопоставления текста и изображения.

Кроме того, объём доступных данных ограничивает способность модели обучаться сложным мультимодальным закономерностям.

---

## Перспективы развития

Для дальнейшего улучшения качества целесообразно использовать специализированные мультимодальные архитектуры, обученные на контрастивной задаче сопоставления текста и изображения.

В частности, модели типа **CLIP** обучаются в общем семантическом пространстве, где текст и изображение проецируются в единое представление. В этом случае степень соответствия может вычисляться напрямую через косинусное сходство без дополнительного регрессора.

Предварительные эксперименты с CLIP показали более устойчивые результаты по качеству ранжирования и тематической согласованности изображений.

---

## Итог

В рамках проекта был реализован полноценный прототип системы мультимодального поиска изображений по текстовому описанию. Были протестированы различные классы моделей, проведена корректная кросс-валидация и реализована демонстрационная функция поиска.

Полученные результаты подтверждают реализуемость подхода, однако также выявляют ограничения классической схемы "независимые эмбеддинги + регрессор". Переход к end-to-end мультимодальным моделям является логичным следующим этапом развития проекта.
